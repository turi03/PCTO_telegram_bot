import requests
from bs4 import BeautifulSoup

import telebot

bot = telebot.TeleBot('1708954723:AAFm6uHWOOtuGAmM465PVKFLnfIbPDebTZI')

URL = 'https://www.isarchimede.edu.it/Orario/'
page = requests.get(URL)

soup = BeautifulSoup(page.content, 'html.parser')

job_elems = soup.find_all('tr')


@bot.message_handler(func=lambda message: True)
def echo_message(message):
    try:
        for job_elem in job_elems:
            href = job_elem.find('a', string=message.text)['href']
            href = href.replace(" ", "%20")
            text = "https://www.isarchimede.edu.it/Orario/" + href
            bot.send_message(message.chat.id, "ecco l' orario: \n" + text)

    except:
        Exception


if __name__ == "__main__":
    bot.polling(none_stop=True)
